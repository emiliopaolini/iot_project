<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<title>Hydroponic Agriculture</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<link rel="stylesheet" type="text/css" media="all" href="./style.css" th:href="@{/style.css}" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4"
		crossorigin="anonymous"></script>

</head>

<body id="tables" onLoad="setInterval(callUpdatePage, 3000)" class="bg-light text-dark">
	<div class="p-3 mb-2 bg-light text-dark">
		<div class=" shadow-sm p-0 mb-5 bg-body rounded " style="margin: 1% 10% 1% 5%;">
			<h1 style="padding-left: 15%;">
				Hydroponic Agriculture Management
				<img src=" ./icon.png"></h1>
		</div>
		<div class="container">
			<div class="row ">
				<div class="col shadow-lg p-3 mb-5 bg-body rounded table-responsive">
					<table class="table table-hover table-success  table-striped">
						<thead>
							<tr>
								<th scope="col">Sensor</th>
								<th scope="col">IP</th>
								<th scope="col">Assigned To</th>
								<th scope="col">Value</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="node: ${sensors}" >
								<td th:utext="${node.nodeResource}"> </td>
								<td th:utext="${node.nodeIP}"> </td>
								<td th:utext="${node.actuator} ? ${node.actuator.nodeIP}: ''"> </td>
								<td th:utext="${node.currentValue}"> </td>
							</tr>
						</tbody>
					</table>
					<table class="table table-hover table-info  table-striped">
						<thead>
							<tr>
								<th scope="col">Actuator</th>
								<th scope="col">IP</th>
								<th scope="col">Status</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="node: ${actuators}" th:status="${node.currentValue}">
								<td th:utext="${node.nodeResource}"> </td>
								<td th:utext="${node.nodeIP}"> </td>
								<td>
									<div class="form-check form-switch">
										<input class="form-check-input" type="checkbox" name="status" value="${node.currentValue == 1} ? ${true}:  ${false}">
									</div>
								</td>
							</tr>
							<tr>
								<td>dummy </td>
								<td>
									<div class="form-check form-switch">
										<input class="form-check-input" type="checkbox" name="status">
									</div>
								</td>
							</tr>

						</tbody>
					</table>

				</div>
				<div class="col"><img src="./landing_image.jpg" style="width:90%; height:90%;"
						class="shadow-lg p-3 mb-5 bg-body rounded">
				</div>
			</div>
		</div>




		<script type="text/javascript" th:inline="javascript">

			function callUpdatePage() {
				// $('#tables').load("/home");
				$.ajax({
					type: 'POST',
					url: "/home"
				});

			}
			const checkboxes = document.querySelectorAll('input[name="status"]');
			checkboxes.forEach((checkbox) => {
				checkbox.addEventListener('click', (event) => {
					if (checkbox.checked) {
						$.ajax({
							type: 'POST',
							url: "/changeStatus"
						});
					} else {

					}
				});
			});

		</script>
	</div>
</body>

</html>